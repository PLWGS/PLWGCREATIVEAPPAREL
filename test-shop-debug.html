<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shop Debug Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background: #1a1a1a;
            color: white;
            padding: 20px;
        }
        .product-card {
            border: 1px solid #00bcd4;
            padding: 15px;
            margin: 10px;
            border-radius: 8px;
            background: rgba(42, 42, 42, 0.8);
        }
        .product-image {
            width: 200px;
            height: 200px;
            object-fit: cover;
            border-radius: 4px;
        }
        .debug-info {
            background: #333;
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>Shop Debug Test</h1>
    
    <div class="debug-info">
        <h3>Debug Information:</h3>
        <div id="debug-output"></div>
    </div>
    
    <div id="products-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px;">
        <!-- Products will be loaded here -->
    </div>

    <script>
        let allProducts = [];
        const productsGrid = document.getElementById('products-grid');
        const debugOutput = document.getElementById('debug-output');

        function log(message) {
            console.log(message);
            debugOutput.innerHTML += '<div>' + message + '</div>';
        }

        async function loadProductsFromDatabase() {
            log('üîÑ Loading products from database...');
            try {
                const response = await fetch('/api/products/public');
                log('üì° API Response status: ' + response.status);
                
                if (response.ok) {
                    const products = await response.json();
                    log('üì¶ Loaded products: ' + products.length);
                    log('üì¶ Products data: ' + JSON.stringify(products, null, 2));
                    
                    allProducts = Array.isArray(products) ? products : [];
                    log('üì¶ Processed products array length: ' + allProducts.length);
                    
                    displayProducts();
                } else {
                    log('‚ùå No products found in database');
                    allProducts = [];
                    displayProducts();
                }
            } catch (error) {
                log('‚ùå Error loading products: ' + error.message);
                allProducts = [];
                displayProducts();
            }
        }

        function displayProducts() {
            log('üé® Displaying products...');
            log('üì¶ Total products: ' + allProducts.length);
            
            if (!productsGrid) {
                log('‚ùå productsGrid element not found!');
                return;
            }
            
            productsGrid.innerHTML = '';
            
            if (allProducts.length === 0) {
                log('‚ö†Ô∏è No products to display');
                productsGrid.innerHTML = '<div style="grid-column: 1/-1; text-align: center; padding: 40px;">No products found</div>';
                return;
            }
            
            allProducts.forEach((product, index) => {
                log('üéØ Creating card for product: ' + product.name);
                
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                
                const productImage = product.image_url || 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiBmaWxsPSIjM0I0QjVCIi8+CjxwYXRoIGQ9Ik0yNSAyNUg3NVY3NUgyNVoiIHN0cm9rZT0iIzAwQkNENCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+CjxwYXRoIGQ9Ik0zNSA0NUw2NSA0NU02NSA2NUwzNSA2NUwzNSA0NVoiIHN0cm9rZT0iIzAwQkNENCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+Cjwvc3ZnPgo=';
                
                productCard.innerHTML = `
                    <h3>${product.name || 'Product'}</h3>
                    <img src="${productImage}" alt="${product.name}" class="product-image" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMDAiIGhlaWdodD0iMTAwIiBmaWxsPSIjM0I0QjVCIi8+CjxwYXRoIGQ9Ik0yNSAyNUg3NVY3NUgyNVoiIHN0cm9rZT0iIzAwQkNENCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+CjxwYXRoIGQ9Ik0zNSA0NUw2NSA0NU02NSA2NUwzNSA2NUwzNSA0NVoiIHN0cm9rZT0iIzAwQkNENCIgc3Ryb2tlLXdpZHRoPSIyIiBmaWxsPSJub25lIi8+Cjwvc3ZnPgo='; this.onerror=null;">
                    <p><strong>Price:</strong> $${product.price || '0.00'}</p>
                    <p><strong>Category:</strong> ${product.category || 'Unknown'}</p>
                    <p><strong>Image URL:</strong> ${product.image_url || 'No image'}</p>
                `;
                
                productsGrid.appendChild(productCard);
                log('‚úÖ Added product card: ' + product.name);
            });
            
            log('‚úÖ Finished displaying products');
        }

        // Load products when page loads
        loadProductsFromDatabase();
    </script>
<script id="dhws-dataInjector" src="/public/dhws-data-injector.js?v=20250809"></script>
</body>
</html> 