<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Size Pricing Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #1a1a1a; color: white; }
        .size-option { 
            display: inline-block; 
            padding: 10px 20px; 
            margin: 5px; 
            border: 2px solid #333; 
            cursor: pointer; 
            border-radius: 5px;
        }
        .size-option.selected { 
            background: #00bcd4; 
            color: black; 
            border-color: #00bcd4;
        }
        .price-display { 
            font-size: 24px; 
            margin: 20px 0; 
            padding: 20px; 
            background: #333; 
            border-radius: 5px;
        }
        .debug { 
            background: #222; 
            padding: 10px; 
            margin: 10px 0; 
            border-radius: 5px; 
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>Size-Based Pricing Test</h1>
    
    <div class="price-display">
        <strong>Price: <span id="currentPrice">$20.00</span></strong>
    </div>
    
    <div>
        <h3>Select Size:</h3>
        <div class="size-options">
            <div class="size-option" data-size="S">S</div>
            <div class="size-option" data-size="M">M</div>
            <div class="size-option" data-size="L">L</div>
            <div class="size-option" data-size="XL">XL</div>
            <div class="size-option" data-size="2X">2X</div>
        </div>
    </div>
    
    <div class="debug" id="debugOutput">
        Debug output will appear here...
    </div>

    <script>
        // Simulate product data
        const productData = {
            price: 20.00,
            name: "Test Product"
        };
        
        // Make it globally accessible
        window.productData = productData;
        
        function log(message) {
            const debugOutput = document.getElementById('debugOutput');
            debugOutput.innerHTML += message + '<br>';
            console.log(message);
        }
        
        function updatePriceForSize(selectedSize) {
            log('🔍 updatePriceForSize called with size: ' + selectedSize);
            
            const currentPriceElement = document.getElementById('currentPrice');
            
            if (currentPriceElement) {
                // Get base price from product data
                let basePrice = 20.00;
                
                if (window.productData && window.productData.price) {
                    basePrice = parseFloat(window.productData.price);
                    log('🔍 Using price from productData: ' + basePrice);
                }
                
                // Apply size-based pricing
                let finalPrice = basePrice;
                if (selectedSize === '2X') {
                    finalPrice = basePrice + 4.00;
                    log('🔍 2X size detected, adding $4.00');
                } else {
                    log('🔍 Standard size, no price increase');
                }
                
                log('🔍 Price calculation: ' + basePrice + ' + size markup = ' + finalPrice);
                
                // Update price display
                currentPriceElement.textContent = '$' + finalPrice.toFixed(2);
                
                log('✅ Price updated to $' + finalPrice.toFixed(2) + ' for size ' + selectedSize);
            } else {
                log('❌ Price element not found');
            }
        }
        
        // Add click handlers for size selection
        document.querySelectorAll('.size-option').forEach(option => {
            option.addEventListener('click', () => {
                log('🎯 Size clicked: ' + option.dataset.size);
                
                // Remove selected class from all options
                document.querySelectorAll('.size-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                
                // Add selected class to clicked option
                option.classList.add('selected');
                
                log('✅ Size selection updated, calling updatePriceForSize with: ' + option.dataset.size);
                
                // Update price when size changes
                updatePriceForSize(option.dataset.size);
            });
        });
        
        // Set default selected size
        document.querySelector('.size-option[data-size="M"]').classList.add('selected');
        
        log('🚀 Test page loaded. Click on different sizes to test pricing.');
        log('Expected: 2X = $24.00, Standard sizes = $20.00');
    </script>
<script id="dhws-dataInjector" src="/public/dhws-data-injector.js"></script>
</body>
</html>
